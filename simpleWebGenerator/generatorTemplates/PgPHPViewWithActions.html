<script type="text/html" id="user_tmpl">
<!-- 
    mroam imat kod updejta i ID i sva ostala polja . neautoinkrementirajuci i PKey polja
    ona koja se automatski psotavljaju mine trebaju
-->
    <pre>
       <code>
        <ol> 
            <li>&lt;?php</li>
<li>    if (! defined(APP_NAME)) { die  ("Application not loaded"); } ></li>            
<li>    switch ($action) {  </li>
<% for ( var i = 0; i < selectedTables.length; i++ ) {           %> 
<%     var schemaName=selectedTables[i].schema;              %>
<%     var tableName=selectedTables[i].table;                %>
<li>	case "<%=schemaName%>_<%=tableName%>_view":                              </li>
<%     var attribsInPkey=generator.getPkeyFieldNames(schemaName,tableName); %>
<%     var attribsInPkeyJoined=attribsInPkey.join(','); %>
<%     var phpArgsPkey = genericHelper.joinArrayWithPRefixes(attribsInPkey, '$', ','); %>
<%     var phpVars = genericHelper.joinArrayWithPRefixes(attribsInPkey, '{$', '},')+'}"'; %>
<%     var phpKeyVarsInStr = genericHelper.joinArrayWithGlues(attribsInPkey, '\'{$', '}\''  ,  ',');   %>
<%     var allAttribs =generator.getTableFieldNamesArr(schemaName,tableName,false); %>
<%     var allAttribsJoined =allAttribs.join(','); %>
<%     var attribsNonAutogenerated=generator.getTableFieldNamesArr(schemaName,tableName,true); %>
<%     var attribsNonAutogeneratedJoined=attribsNonAutogenerated.join(','); %>
<%     var phpArgs = genericHelper.joinArrayWithPRefixes(attribsNonAutogenerated, '$', ','); %>
<%     var phpVars = genericHelper.joinArrayWithPRefixes(generator.getTableFieldNamesArr(schemaName,tableName,true), '{$', '},')+'}"'; %>
<%     var funcName = generator.getFunctionName(schemaName,tableName,false); %>            

            
<%      for ( var j = 0; j < attribsInPkey.length; j++ ) {           %>
<%           var fieldName = attribsInPkey[j]; %>
<%           var fieldDataType = generator.getFieldGenericDataType(schemaName,tableName,fieldName); %>
            <li>     $<%=fieldName%> = (isset($_POST[&quot;<%=fieldName%>&quot;]))?$_POST[&quot;<%=fieldName%>&quot;]: die (&quot;Variable <%=fieldName%> not set &quot;); </li>
<%           var antiInjector = generator.genericDataType2PhpInject(fieldDataType,fieldName); %>
            <li>     $<%=fieldName%> = <%=antiInjector%>;</li> 
            <li>    $data[&quot;data&quot;]=$this->db-><%=funcName%>Get(<%=phpArgsPkey%>);     </li>
            <li>    echo json_encode($data);     </li>
<%      } %>            
<li>	break;                                                                   </li>
<% }       %>
<li>    }  </li>
<li>?&gt;</li>
            
        </ol>
           
   </code>
    </pre>
 </script>
