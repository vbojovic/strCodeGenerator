<script type="text/html" id="user_tmpl">
      <pre>
       <code>
            <ol>   
                <li>### .env (prisma file) ###</li>
                <li>DATABASE_URL="postgresql://postgres:sragne@localhost:5432/growr?schema=public"</li>
            </ol>
            <ol>   
                <li>### shell commands for creating nodejs project with prisma and nextJS ###</li>
                
                <li>npm init -y</li>
                <li>npm install prisma typescript ts-node @types/node --save-dev</li>
                <li>npx tsc --init</li>
                
                <li>npx prisma init</li>
                <!--<li>npx prisma db validate</li>-->
                <li>npx prisma db pull --force</li>
                <li>npx prisma db generate</li>
                <!--<li>npx prisma migrate dev --name init</li>-->
                <li>npm install @prisma/client</li>
                <li>npm install express pg sequelize express-session express-validator bcrypt passport passport-local connect-flash
</li>
            </ol>
        </code>    
       <code>
            <ol>   
                <li>//### importData.ts ###</li>
                <li>//npx ts-node importData.ts</li>
                <li>const NUMBER_OF_RECORDS=10</li>
                <li>import { PrismaClient } from "@prisma/client"</li>
                <li>const prisma = new PrismaClient()</li>
                <li>async function main() {</li>
                <li>&nbsp;for (var i=0; i< NUMBER_OF_RECORDS; i++){</li>
<% 
    var code=[];
    for ( var i = 0; i < selectedTables.length; i++ ) { 
        var schemaName=selectedTables[i].schema; 
        var tableName=selectedTables[i].table; 
        var funcName = generator.getFunctionName(schemaName,tableName,false); 
        var attribsNonAutogenerated=generator.getTableFieldNamesArr(schemaName,tableName,true);  
        var allAttribs = generator.getTableFieldNamesArr(schemaName,tableName,false);  
        var phpArgs = genericHelper.joinArrayWithPRefixes(allAttribs, '$', ',');  
        var pkeyFields = generator.getPkeyFieldNames(schemaName, tableName);

        var allAttribs=generator.getTableFieldNamesArr(schemaName,tableName,false);  
        var listingFields = genericHelper.joinArrayWithPRefixes(allAttribs, '', '","');  
        var listingFields = '"'+listingFields+'"'; 
       
        var schemaName=selectedTables[i].schema;
        var tableName=selectedTables[i].table;
        var allAttribs =generator.getTableFieldNamesArr(schemaName.toLowerCase(),tableName.toLowerCase(),true);   
        var fields = generator.getTableFields(schemaName, tableName, true);
                
       var pKeyFields=generator.getPkeyFieldNames(schemaName,tableName);
       
       code.push("await prisma."+tableName+".create({");
            code.push("data: {");

            for ( var j = 0; j < fields.length; j++ ) {
                var field = fields[j]; 
                var isFk = generator.isFieldPartOfFKey(schemaName, tableName, field.fieldName);
                var gType = field.genericDataType.trim();

                var types = generator.genericDataTypes;
                var fieldName = field.fieldName.trim();                
                var fieldCode=schemaName+"_"+tableName+"_"+fieldName;
                fieldCode=fieldCode.toUpperCase();
                
                if (isFk){
                    
                    /*code.push(fieldName+" - ANOTHER TABLE");*/
                    code.push("   "+fieldName+":"+"i"+",");
                    continue;
                } else {
                    if (pkeyFields.includes(fieldName)) continue;
                    
                    if (generator.isUserField(field.fieldName)){
                        code.push("     "+fieldName+": i,");
                        continue;
                    }
                    
                    switch(gType){
                          case 'uid':
                              break;        
                          case 'varchar':
                              code.push("     "+fieldName+": \""+fieldName+" - \""+"+i,");
                              break;
                          case 'text':
                              code.push("   "+fieldName+": \""+fieldName+" - \""+"+i,");
                              break;
                          case 'char':
                              code.push("   "+fieldName+": \""+fieldName.substr(0,1)+"\",");
                              break;
                          case 'integer':
                              code.push("   "+fieldName+":"+"i"+",");
                              break;          
                          case 'bigint':
                              code.push("   "+fieldName+":"+"i"+",");
                              break;  
                          case 'double':
                              code.push("   "+fieldName+": i/7 ,");
                              break;                                    
                          case 'bool':
                              code.push("   "+fieldName+": true ,");
                              break;
                          case 'date':
                              code.push("   "+fieldName+": \"2023-09-\"+"+"(\"0\"+i).slice(-2)"+",");
                              break;
                          case 'time':
                              code.push("   "+fieldName+": \"14:30:\""+"+(\"00\"+i).slice(-2)"+",");
                              break;                              
                          default :
                              code.push("field type not found!");
                              code.push(name);
                              code.push(gType);    
                              console.log(field);
                              break;
                    }
                }
            }

            code.push("}");
       code.push("})")   ;
     }
     
     code.push("    }");
     
     for (var i = 0; i < code.length; i++) {
        %> <li> <%= code[i] %></li><%
     }
     code=[];
%>
            <li>}</li>
            <li>main()</li>
            <li>  .then(async () => {</li>
            <li>    await prisma.$disconnect()</li>
            <li>  })</li>
            <li>  .catch(async (e) => {</li>
            <li>    console.error(e)</li>
            <li>    await prisma.$disconnect()</li>
            <li>    process.exit(1)</li>
            <li>  })</li>

            </ol>
        </code>    
 

    
    
    
</script>

